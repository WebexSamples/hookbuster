{"version":3,"sources":["while-in-flight.js"],"names":["whileInFlight","param","whileInFlightDecorator","target","name","descriptor","value","whileInFlightExecutor","fn","args","resolve","then","catch","reason","reject"],"mappings":";;;;;;;;;;;;;;;;;;kBAewBA,a;;AARxB;;;;;;AAEA;;;;;;AAMe,SAASA,aAAT,CAAuBC,KAAvB,EAA8B;AAC3C,SAAO,SAASC,sBAAT,CAAgCC,MAAhC,EAAwCC,IAAxC,EAA8CC,UAA9C,EAA0D;AAC/DA,eAAWC,KAAX,GAAmB,oBAAKD,WAAWC,KAAhB,EAAuB,SAASC,qBAAT,CAA+BC,EAA/B,EAA4C;AAAA;;AAAA,wCAANC,IAAM;AAANA,YAAM;AAAA;;AACpF,aAAO,sBAAY,UAACC,OAAD,EAAa;AAC9B,cAAKT,KAAL,IAAc,IAAd;AACAS,gBAAQ,qBAAcF,EAAd,EAAkB,KAAlB,EAAwBC,IAAxB,EACLE,IADK,CACA,mBAAI,YAAM;AACd,gBAAKV,KAAL,IAAc,KAAd;AACD,SAFK,CADA,EAILW,KAJK,CAIC,UAACC,MAAD,EAAY;AACjB,gBAAKZ,KAAL,IAAc,KAAd;;AAEA,iBAAO,kBAAQa,MAAR,CAAeD,MAAf,CAAP;AACD,SARK,CAAR;AASD,OAXM,CAAP;AAYD,KAbkB,CAAnB;AAcD,GAfD;AAgBD,C,CAhCD;;;;AAIA","file":"while-in-flight.js","sourcesContent":["/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\n/* eslint no-invalid-this: [0] */\n\nimport {wrap} from 'lodash';\nimport tap from './tap';\n\n/**\n * While the promise returned by the decorated is unfullfilled, sets, the\n * specified boolean on the target class to `true`\n * @param {string} param\n * @returns {Function}\n */\nexport default function whileInFlight(param) {\n  return function whileInFlightDecorator(target, name, descriptor) {\n    descriptor.value = wrap(descriptor.value, function whileInFlightExecutor(fn, ...args) {\n      return new Promise((resolve) => {\n        this[param] = true;\n        resolve(Reflect.apply(fn, this, args)\n          .then(tap(() => {\n            this[param] = false;\n          }))\n          .catch((reason) => {\n            this[param] = false;\n\n            return Promise.reject(reason);\n          }));\n      });\n    });\n  };\n}\n"]}